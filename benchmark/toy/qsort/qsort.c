// In-place quicksort
// sample size 50
// iteration 163 = 76 + 87 
// [100] 493 = 260 + 233
#include <stdio.h>

/*
const int output[100] = {1, 1, 3, 3, 3, 3, 5, 9, 17, 18, 21, 24, 34, 
	44, 44, 48, 62, 62, 94, 100, 101, 111, 124, 170, 170, 214, 
	231, 234, 235, 235, 256, 257, 314, 352, 412, 432, 453, 453, 453, 457, 523, 552, 566, 588, 590, 591, 621, 662, 664, 666, 710, 716, 719, 720, 722, 747, 763, 797, 800, 809, 813, 815, 816, 823, 830, 846, 861, 865, 887, 911, 913, 937, 937, 949, 952, 970, 985, 1000, 1010, 1012, 1031, 1043, 1043, 1043, 1047, 1099, 1112, 1121, 1147, 1174, 1176, 1221, 1231, 1242, 1245, 1290, 2214, 2222, 2412, 2622};
*/

/*
const int output[50] = {1, 1, 17, 18, 21, 34, 94, 100, 257, 314, 432, 552, 566, 588, 591, 621, 662, 710, 716, 720, 747, 763, 797, 800, 809, 813, 816, 830, 846, 861, 865, 887, 911, 913, 949, 970, 985, 1000, 1010, 1012, 1031, 1047, 1099, 1112, 1121, 1147, 1174, 1176, 1221, 1231};
*/

int arr[50/*100*/] =  { 1176, 1112, 716, 720, 816, 970, 911, 846, 865, 800,
                        588, 591, 621, 432, 552, 710, 1047, 985, 1231, 1174,
                        18, 1010, 257, 1221, 100, 887, 566, 830, 314, 21,
				        1147, 17, 1099, 1, 1121, 94, 809, 1, 861, 34,
                        1031, 1000, 949, 913, 1012, 813, 797, 747, 763, 662/*,
                        590, 664, 719, 937, 1043, 815, 453, 170, 44, 3,
                        2622, 2214, 62, 937, 1043, 5, 3, 170, 44, 3,
                        722, 2222, 1242, 234, 1043, 256, 453, 352, 231, 3,
                        457, 24, 124, 2412, 48, 235, 453, 952, 1245, 412,
                        235, 666, 1290, 101, 523, 823, 111, 214, 62, 9*/}; 

int main() {

    int piv, L, R, swap;
    int i = 0;
    int beg[50/*100*/], end[50/*100*/];

    //int counter = 0; 

    beg[0]=0; end[0]=50/*100*/;

    while (i>=0) {

        L=beg[i]; R=end[i]-1;

        if (L<R) {

            piv=arr[L];

            while (L<R) {
                while (arr[R]>=piv && L<R){ 
			        R--; 
                    //counter = counter + 1;
                }

		        if (L<R) 
			        arr[L++]=arr[R];

                while (arr[L]<=piv && L<R) {
			       L++;
                   //counter = counter + 1;
                }

		        if (L<R) 
			        arr[R--]=arr[L]; 
	        }

            arr[L]=piv; 
	        beg[i+1]=L+1; 
	        end[i+1]=end[i]; 
	        end[i++]=L;

            if ((end[i]-beg[i]) > (end[i-1]-beg[i-1])) {
                swap=beg[i]; 
                beg[i]=beg[i-1]; 
                beg[i-1]=swap;
                swap=end[i]; 
                end[i]=end[i-1]; 
                end[i-1]=swap; 
            }
        }
        else {
            i--; 
	    }
    }
    
    //for(i = 0; i < 50/*100*/; i++) {
  	//    printf("%d, ", arr[i]);
    //}
    //printf ("%d", counter);
}
